# RisuAI 한땀한땀 수정 플러그인

RisuAI에서 LLM 응답을 **정밀하게 수정**할 수 있는 플러그인입니다.

## 주요 기능

### 텍스트 선택 편집 모드 (기본)

텍스트를 드래그해서 선택하면 **편집/삭제** 버튼이 나타납니다.

- 원하는 텍스트를 마우스로 드래그하여 선택 (최소 5글자)
- 선택 영역 위에 플로팅 버튼 표시
- **편집**: 선택한 텍스트를 수정
- **삭제**: 선택한 텍스트를 제거

### 요소 기반 편집 모드

단락/블록 단위로 편집 버튼이 표시됩니다.

- 채팅 메시지에 마우스를 올리면 편집 버튼(✏️) 표시
- 버튼 클릭 시 해당 블록 전체 편집 가능
- `Ctrl+Shift+E`로 모드 전환

### 스크롤 위치 자동 복원 (Anchoring)

수정 후에도 **원래 보던 위치가 유지**됩니다.

- 정규식 적용으로 DOM이 재생성되어도 스크롤 위치 복원
- 수정된 영역 하이라이트 표시로 수정 위치 시각적 확인

### 다중 매칭 처리

같은 텍스트가 여러 곳에 있으면 **선택 모달**이 표시됩니다.

- 컨텍스트와 줄 번호로 정확한 위치 파악
- 매칭 방법 표시 (정확/유사/앵커)

### 삭제 애니메이션

텍스트 삭제 시 **시각적 피드백**을 제공합니다.

---

## 사용법

### 텍스트 선택 편집 (권장)

1. 수정할 텍스트를 마우스로 드래그
2. 나타나는 **편집** 버튼 클릭
3. 다이얼로그에서 텍스트 수정
4. **저장** 클릭 (또는 `Ctrl+Enter`)

### 요소 기반 편집

1. `Ctrl+Shift+E`로 모드 전환
2. 메시지에 마우스 올리면 ✏️ 버튼 표시
3. 버튼 클릭하여 블록 편집
4. **저장** 또는 **취소**

### 단축키

| 단축키 | 기능 |
|--------|------|
| `Ctrl+Shift+E` | 편집 모드 전환 |
| `Ctrl+Enter` | 편집 저장 |
| `Esc` | 편집 취소 |

---

## 설치 방법

1. RisuAI 설정 → 플러그인
2. 플러그인 URL 입력:
   ```
   https://unpkg.com/risu-handdam-edit@latest/dist/risu-handdam-edit.js
   ```
3. 플러그인 활성화

---

## 설정 옵션

| 옵션 | 설명 | 기본값 |
|------|------|--------|
| 편집 모드 | `selection` (텍스트 선택) / `element` (요소 기반) | `selection` |
| 버튼 위치 | `top` (상단) / `bottom` (하단) | `top` |
| 제외할 봇 이름 | 편집 비활성화할 캐릭터 이름 (쉼표 구분) | - |

---

## 개발자 정보

### 빌드

```bash
npm install
npm run build
```

### 개발 모드 (Hot Reload)

```bash
npm run dev
```

### 프로젝트 구조

```
src/
├── core/
│   ├── edit-manager.js          # 편집 기능 총괄
│   ├── text-selection-handler.js # 텍스트 선택 처리
│   └── element-edit-handler.js   # 요소 기반 편집
├── ui/
│   ├── styles/                   # CSS 스타일
│   └── components/               # UI 컴포넌트
└── utils/
    └── text-matcher.js           # 텍스트 매칭 유틸리티
```

---

## 라이선스

MIT License
